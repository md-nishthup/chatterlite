FROM node:20-alpine
WORKDIR /srv
COPY package*.json ./ 2>/dev/null || true
# Install only needed deps (explicit list to avoid pulling dev root)
RUN npm init -y && npm install express node-fetch cors dotenv
COPY astrochat-server.cjs ./
ENV NODE_ENV=production
EXPOSE 4001
CMD ["node", "astrochat-server.cjs"]
